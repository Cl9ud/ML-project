# All Libraries required for this lab are listed below.
!pip install pandas==1.3.4
!pip install scikit-learn==1.0.2
!pip install numpy==1.21.6

# You can also use this section to suppress warnings generated by your code:
def warn(*args, **kwargs):
    pass
import warnings
warnings.warn = warn
warnings.filterwarnings('ignore')

import pandas as pd
from sklearn.linear_model import LinearRegression

# the data set is available at the url below.
URL = "https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-BD0231EN-SkillsNetwork/datasets/mpg.csv"

# using the read_csv function in the pandas library, we load the data into a dataframe.

df = pd.read_csv(URL)

df.sample(5)
df.shape

df.plot.scatter(x = "Horsepower", y = "MPG")

#Identify the target column and the data columns
target = df["MPG"]
features = df[["Horsepower","Weight"]]

#Build and Train a Linear Regression Model

lr = LinearRegression()
lr.fit(features,target)

#Evaluate the model and make predictions

#Higher the score, better the model.
lr.score(features,target)
lr.predict([[100,2000]])
